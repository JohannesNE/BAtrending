<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to BAtrending • BAtrending</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="BAtrending_files/libs/quarto-html/popper.min.js"></script><script src="BAtrending_files/libs/quarto-html/tippy.umd.min.js"></script><link href="BAtrending_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="BAtrending_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to BAtrending">
<meta property="og:image" content="https://johannesne.github.io/BAtrending/logo.png">
<!-- Cloudflare Web Analytics --><script defer src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon='{"token": "3a337c45c64f439e9f2e853215f94689"}'></script><!-- End Cloudflare Web Analytics -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BAtrending</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/BAtrending.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/johannesne/BAtrending/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to BAtrending</h1>




      <small class="dont-index">Source: <a href="https://github.com/johannesne/BAtrending/blob/main/vignettes/BAtrending.qmd" class="external-link"><code>vignettes/BAtrending.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <section class="level2"><h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<div class="line-block">First, install the package using <code>pak::pak("JohannesNE/BAtrending")</code><br>
or <code>remotes::install_github("JohannesNE/BAtrending")</code>.</div>
<p>Load the package (this tutorial also uses the package <code>dplyr</code>):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/johannesne/BAtrending" class="external-link">BAtrending</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
</div>
</section><section class="level2"><h2 id="a-simple-example">A simple example<a class="anchor" aria-label="anchor" href="#a-simple-example"></a>
</h2>
<p>The BAtrending package includes a small sample dataset, <code>CO</code>. It contains paired measurements of cardiac output (CO) using two methods: radionuclide ventriculography (rv) and impedance cardiography (ic). The dataset was published in <a href="https://doi.org/10.1177/096228029900800204" class="external-link">Bland JM, Altman DG. (1999) Measuring agreement in method comparison studies. Statistical Methods in Medical Research 8, 135-160</a>.</p>
<p>The <code>CO</code> dataset contains 60 measurements from 12 subjects.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">CO</span><span class="op">)</span></span>
<span><span class="co">#&gt;   sub   rv   ic</span></span>
<span><span class="co">#&gt; 1   1 7.83 6.57</span></span>
<span><span class="co">#&gt; 2   1 7.42 5.62</span></span>
<span><span class="co">#&gt; 3   1 7.89 6.90</span></span>
<span><span class="co">#&gt; 4   1 7.12 6.57</span></span>
<span><span class="co">#&gt; 5   1 7.88 6.35</span></span>
<span><span class="co">#&gt; 6   2 6.16 4.06</span></span></code></pre></div>
</div>
<p><code><a href="../reference/compare_methods.html">compare_methods()</a></code> is the primary analysis function in <code>BAtrending</code>.</p>
<p><code><a href="../reference/compare_methods.html">compare_methods()</a></code> uses <code><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lme4::lmer()</a></code> to fit a mixed model with differences (<code>D = alt - ref</code>) as the dependent variable. From this model, Bland-Altman statistics and trending parameters are calculated, accounting for repeated measurements. Additionally, a mixed model with averages (<code>avg = (alt + ref)/2</code>) as the dependent variable is fit. This second model is used to determine the between-subject and within-subject distribution of the measured variable. Later, we demonstrate how to <a href="#manually-fit-the-mixed-model-and-extract-features">manually fit the mixed model and extract relevant features</a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">BA_CO</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compare_methods.html">compare_methods</a></span><span class="op">(</span></span>
<span>  <span class="va">CO</span>,</span>
<span>  ref_col <span class="op">=</span> <span class="va">rv</span>,</span>
<span>  alt_col <span class="op">=</span> <span class="va">ic</span>,</span>
<span>  id_col <span class="op">=</span> <span class="va">sub</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Bootstrap confidence intervals.</span></span>
<span><span class="co"># `nsim` should probably be at least 2000 for real use.</span></span>
<span><span class="va">BA_CO</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_confint.html">add_confint</a></span><span class="op">(</span><span class="va">BA_CO</span>, nsim <span class="op">=</span> <span class="fl">999</span>, .progress <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
</div>
<p>We can view the raw data (<code>rv</code> and <code>ic</code>) using <code><a href="../reference/BA_plot_scatter.html">BA_plot_scatter()</a></code>. It is generally recommended to set the aspect ratio to 1 for easy comparison between the methods.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/BA_plot_scatter.html">BA_plot_scatter</a></span><span class="op">(</span><span class="va">BA_CO</span>, aspect_ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="BAtrending_files/figure-html/unnamed-chunk-3-1.png" class="quarto-figure quarto-figure-center" style="width:50.0%"></p>
</figure>
</div>
</div>
</div>
<p>A standard Bland-Altman plot is created with <code><a href="../reference/BA_plot.html">BA_plot()</a></code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/BA_plot.html">BA_plot</a></span><span class="op">(</span><span class="va">BA_CO</span>, aspect_ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="BAtrending_files/figure-html/unnamed-chunk-4-1.png" class="quarto-figure quarto-figure-center" style="width:50.0%"></p>
</figure>
</div>
</div>
</div>
<p><code><a href="../reference/BA_plot_combine.html">BA_plot_combine()</a></code> is a convenience function that combines three plots: the scatter plot and Bland-Altman plot shown above and a residuals plot. The residuals plot shows only the within-subject variation, which is the only variation relevant for assessing trending agreement (the residuals plot can be created directly with <code><a href="../reference/BA_plot_residuals.html">BA_plot_residuals()</a></code>).</p>
<p>Setting <code>equal_scales = TRUE</code> (default) matches the dimensions of the residuals plot to the standard Bland-Altman plot, so we can visually compare the within-subject variation (right panel) to the total variation shown in the Bland-Altman analysis (middle panel).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/BA_plot_combine.html">BA_plot_combine</a></span><span class="op">(</span><span class="va">BA_CO</span>, aspect_ratio <span class="op">=</span> <span class="fl">1</span>, equal_scales <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="BAtrending_files/figure-html/unnamed-chunk-5-1.png" class="quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>On the Y-axis of the residuals plot, we observe that there is little within-subject variation in the difference between simultaneous measurements, especially compared to the total variation (Y-axis of the middle panel). By itself, this suggests good trending agreement, but we must also consider how much CO acutally varied in the study. The average CO (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>r</mi><mi>v</mi><mo>+</mo><mi>i</mi><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">(rv+ic)/2</annotation></semantics></math>) represents our best guess of the true CO and is plotted on the X-axis of the middle and right panels. The middle panel shows that a wide range of CO values are included in the study, but the right panel reveals that the within-subject variation in CO is very limited. We do not know how the within-subject variability would change if CO itself varied significantly within subjects; therefore, we cannot confidently interpret the low within-subject variability as “good” trending agreement.</p>
<p>The results from the analysis can be shown in table form in the console with <code>print(BA_CO)</code> or by simply calling the object name:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">BA_CO</span></span>
<span><span class="co">#&gt; 60 paired measurements in 12 subjects</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                    est      [95% CI] </span></span>
<span><span class="co">#&gt; === Distribution ===</span></span>
<span><span class="co">#&gt; Mean                           :   5.035 [ 4.377;  5.726] </span></span>
<span><span class="co">#&gt; Between-subject variation (SD) :   1.210 [ 0.686;  1.769] </span></span>
<span><span class="co">#&gt; Within-subject variation (SD)  :   0.283 [ 0.226;  0.336] </span></span>
<span><span class="co">#&gt; Total variation (SD)           :   1.243 [ 0.752;  1.794] </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Method comparison ===</span></span>
<span><span class="co">#&gt; Bias (alt - ref)               :  -0.705 [-1.244; -0.139] </span></span>
<span><span class="co">#&gt; Between-subject variation (SD) :   0.934 [ 0.504;  1.323] </span></span>
<span><span class="co">#&gt; Within-subject variation (SD)  :   0.413 [ 0.326;  0.494] </span></span>
<span><span class="co">#&gt; Total variation (SD)           :   1.022 [ 0.650;  1.384] </span></span>
<span><span class="co">#&gt; Intraclass correlation</span></span>
<span><span class="co">#&gt; └ Between/Total variance       :   0.836 [ 0.606;  0.923] </span></span>
<span><span class="co">#&gt; Limits of agreement (95%)</span></span>
<span><span class="co">#&gt; ├ Upper limit                  :   1.298 [ 0.367;  2.250] </span></span>
<span><span class="co">#&gt; └ Lower limit                  :  -2.707 [-3.538; -1.766] </span></span>
<span><span class="co">#&gt; Percentage error               :   0.398 [ 0.254;  0.540] </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Trending ---</span></span>
<span><span class="co">#&gt; Within-subject perc. error     :   0.161 [ 0.127;  0.193] </span></span>
<span><span class="co">#&gt; Change LoA [±] (95%)           :   1.146 [ 0.904;  1.369]</span></span></code></pre></div>
</div>
<p>A publication-ready table is created with:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/BA_table.html">BA_table</a></span><span class="op">(</span><span class="va">BA_CO</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<!-- preamble start -->

    <!-- tinytable mathjax start -->
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script><!-- tinytable mathjax end --><script>

      function styleCell_jvzwj0c5y10ogbahundt(i, j, css_id) {
          var table = document.getElementById("tinytable_jvzwj0c5y10ogbahundt");
          var cell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function spanCell_jvzwj0c5y10ogbahundt(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_jvzwj0c5y10ogbahundt");
        const targetCell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
        if (!targetCell) {
          console.warn(`Cell at (${i}, ${j}) not found.`);
        }

        // Get all cells that need to be removed
        const cellsToRemove = [];
        for (let r = 0; r < rowspan; r++) {
          for (let c = 0; c < colspan; c++) {
            if (r === 0 && c === 0) continue; // Skip the target cell
            const cell = table.querySelector(`[data-row="${i + r}"][data-col="${j + c}"]`);
            if (cell) {
              cellsToRemove.push(cell);
            }
          }
        }

        // Remove all cells
        cellsToRemove.forEach(cell => cell.remove());

        // Set rowspan and colspan of the target cell if it exists
        if (targetCell) {
          targetCell.rowSpan = rowspan;
          targetCell.colSpan = colspan;
        }
      }
      // tinytable span after
      window.addEventListener('load', function () { spanCell_jvzwj0c5y10ogbahundt(11, 0, 1, 2) })
      window.addEventListener('load', function () { spanCell_jvzwj0c5y10ogbahundt(6, 0, 1, 2) })
      window.addEventListener('load', function () { spanCell_jvzwj0c5y10ogbahundt(1, 0, 1, 2) })
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: '16', j: 0 }, { i: '16', j: 1 },  ], css_id: 'tinytable_css_jzsegx371m1m4dsaqe13',},
          { positions: [ { i: '0', j: 0 }, { i: '0', j: 1 },  ], css_id: 'tinytable_css_0h9ea54typbvg28gancn',},
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_jvzwj0c5y10ogbahundt(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script><style>
      /* tinytable css entries after */
      .table td.tinytable_css_jzsegx371m1m4dsaqe13, .table th.tinytable_css_jzsegx371m1m4dsaqe13 { border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_0h9ea54typbvg28gancn, .table th.tinytable_css_0h9ea54typbvg28gancn { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
<div class="container">
      <table class="table table table-borderless" id="tinytable_jvzwj0c5y10ogbahundt" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
<thead><tr>
<th scope="col" data-row="0" data-col="0"></th>
                <th scope="col" data-row="0" data-col="1">Estimate [95% CI]</th>
              </tr></thead>
<tfoot>
<tr><td colspan="2">
<sup>1</sup> Distribution of the averages of simultaneous measurements (alt + ref)/2.</td></tr>
<tr><td colspan="2">
<sup>2</sup> Percentage error = 1.96 · \(\sigma_{total,D}\) (or \(\sigma_{within,D}\))/mean</td></tr>
<tr><td colspan="2">
<sup>3</sup> Change limits of agreement (95%) = 1.96 · √2 · \(\sigma_{within,D}\).</td></tr>
<tr><td colspan="2">
<sup></sup> SD: standard deviation; alt: alternative method; ref: reference method</td></tr>
</tfoot>
<tbody>
<tr>
<td data-row="1" data-col="0">
<strong>Distribution</strong><sup>1</sup>
</td>
                  <td data-row="1" data-col="1"><strong>Distribution</strong></td>
                </tr>
<tr>
<td data-row="2" data-col="0">Mean</td>
                  <td data-row="2" data-col="1">5.03 [4.38; 5.73]</td>
                </tr>
<tr>
<td data-row="3" data-col="0">Between-subject SD</td>
                  <td data-row="3" data-col="1">1.21 [0.69; 1.77]</td>
                </tr>
<tr>
<td data-row="4" data-col="0">Within-subject SD</td>
                  <td data-row="4" data-col="1">0.28 [0.23; 0.34]</td>
                </tr>
<tr>
<td data-row="5" data-col="0">Total SD</td>
                  <td data-row="5" data-col="1">1.24 [0.75; 1.79]</td>
                </tr>
<tr>
<td data-row="6" data-col="0"><strong>Method comparison (alt - ref)</strong></td>
                  <td data-row="6" data-col="1"><strong>Method comparison (alt - ref)</strong></td>
                </tr>
<tr>
<td data-row="7" data-col="0">Bias</td>
                  <td data-row="7" data-col="1">-0.70 [-1.24; -0.14]</td>
                </tr>
<tr>
<td data-row="8" data-col="0">Between-subject SD (\(\sigma_{between,D}\))</td>
                  <td data-row="8" data-col="1">0.93 [0.50; 1.32]</td>
                </tr>
<tr>
<td data-row="9" data-col="0">Within-subject SD (\(\sigma_{within,D}\))</td>
                  <td data-row="9" data-col="1">0.41 [0.33; 0.49]</td>
                </tr>
<tr>
<td data-row="10" data-col="0">Total SD (\(\sigma_{total,D}\))</td>
                  <td data-row="10" data-col="1">1.02 [0.65; 1.38]</td>
                </tr>
<tr>
<td data-row="11" data-col="0">Limits of agreement (95%)</td>
                  <td data-row="11" data-col="1">Limits of agreement (95%)</td>
                </tr>
<tr>
<td data-row="12" data-col="0">  Upper limit</td>
                  <td data-row="12" data-col="1">1.30 [0.37; 2.25]</td>
                </tr>
<tr>
<td data-row="13" data-col="0">  Lower limit</td>
                  <td data-row="13" data-col="1">-2.71 [-3.54; -1.77]</td>
                </tr>
<tr>
<td data-row="14" data-col="0">Percentage error<sup>2</sup>
</td>
                  <td data-row="14" data-col="1">39.8 [25.4; 54.0] %</td>
                </tr>
<tr>
<td data-row="15" data-col="0">Within-subject percentage error<sup>2</sup>
</td>
                  <td data-row="15" data-col="1">16.1 [12.7; 19.3] %</td>
                </tr>
<tr>
<td data-row="16" data-col="0">Change limits of agreement (95%)<sup>3</sup>
</td>
                  <td data-row="16" data-col="1">±1.15 [0.90; 1.37]</td>
                </tr>
</tbody>
</table>
</div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
<p><code><a href="../reference/BA_table.html">BA_table()</a></code> uses <code><a href="https://vincentarelbundock.github.io/tinytable/man/tt.html" class="external-link">tinytable::tt()</a></code> and can be exported to several common formats including PDF and .docx (see <code><a href="https://vincentarelbundock.github.io/tinytable/man/save_tt.html" class="external-link">tinytable::save_tt()</a></code>).</p>
</section><section class="level2"><h2 id="proportional-errors---logarithmic-transformation">Proportional errors - logarithmic transformation<a class="anchor" aria-label="anchor" href="#proportional-errors---logarithmic-transformation"></a>
</h2>
<p>In the example above, we assumed that measurement errors were independent of the true CO. This assumption is supported by the Bland-Altman plot and residuals plots, which do not indicate a relationship between the average CO and the variation in measurement differences.</p>
<p>However, it is common to encounter data, or have prior knowledge, suggesting that measurement errors increase proportionally to the measured value.</p>
<p>In the following section, we will simulate simultaneous measurements of CO with two methods that have measurement errors proportional to the true CO.</p>
<p>First, we simulate 5 true CO values in each of 50 subjects. <code>BAtrending</code> provides a convenience function, <code><a href="../reference/simulate_repeated_data.html">simulate_repeated_data()</a></code>, for this purpose.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim_CO</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_repeated_data.html">simulate_repeated_data</a></span><span class="op">(</span></span>
<span>  n_sub <span class="op">=</span> <span class="fl">50</span>, <span class="co"># subjects</span></span>
<span>  n_rep <span class="op">=</span> <span class="fl">5</span>, <span class="co"># repetitions</span></span>
<span>  avg <span class="op">=</span> <span class="fl">5</span>, <span class="co"># Overall average CO.</span></span>
<span>  <span class="co"># Between-subject variation in CO</span></span>
<span>  between_sub_sd <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  <span class="co"># Within-subject variation in CO (relative to the mean CO for the subject).</span></span>
<span>  within_sub_rel_change_sd <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  var_name <span class="op">=</span> <span class="st">"co_true"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sim_CO</span><span class="op">)</span></span>
<span><span class="co">#&gt;   id  co_true</span></span>
<span><span class="co">#&gt; 1  1 5.281320</span></span>
<span><span class="co">#&gt; 2  1 3.900623</span></span>
<span><span class="co">#&gt; 3  1 5.191799</span></span>
<span><span class="co">#&gt; 4  1 3.339882</span></span>
<span><span class="co">#&gt; 5  1 7.204108</span></span>
<span><span class="co">#&gt; 6  2 9.223510</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">sim_CO</span><span class="op">$</span><span class="va">co_true</span>, breaks <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="BAtrending_files/figure-html/unnamed-chunk-8-1.png" class="quarto-figure quarto-figure-center" style="width:50.0%"></p>
</figure>
</div>
</div>
</div>
<p>Now, we simulate measurements of the true CO using the function <code><a href="../reference/simulate_measurement.html">simulate_measurement()</a></code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_CO</span> <span class="op">&lt;-</span> <span class="va">sim_CO</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="co"># Reference method</span></span>
<span>    ref <span class="op">=</span> <span class="fu"><a href="../reference/simulate_measurement.html">simulate_measurement</a></span><span class="op">(</span></span>
<span>      true_val <span class="op">=</span> <span class="va">co_true</span>,</span>
<span>      sub_id <span class="op">=</span> <span class="va">id</span>,</span>
<span>      mean_bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, <span class="co"># 0, no bias.</span></span>
<span>      <span class="co"># between-subject variation of 5% of true CO.</span></span>
<span>      sub_bias_sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1.05</span><span class="op">)</span>,</span>
<span>      <span class="co"># within-subject variation of 5% of true CO.</span></span>
<span>      residual_error_sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1.05</span><span class="op">)</span>,</span>
<span>      proportional_errors <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="co"># Alternative method</span></span>
<span>    alt <span class="op">=</span> <span class="fu"><a href="../reference/simulate_measurement.html">simulate_measurement</a></span><span class="op">(</span></span>
<span>      true_val <span class="op">=</span> <span class="va">co_true</span>,</span>
<span>      sub_id <span class="op">=</span> <span class="va">id</span>,</span>
<span>      mean_bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1.1</span><span class="op">)</span>, <span class="co"># 10% higher than true CO.</span></span>
<span>      <span class="co"># between-subject variation of 10% of true CO.</span></span>
<span>      sub_bias_sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1.1</span><span class="op">)</span>,</span>
<span>      <span class="co"># within-subject variation of 5% of true CO.</span></span>
<span>      residual_error_sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1.05</span><span class="op">)</span>,</span>
<span>      proportional_errors <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sim_CO</span><span class="op">)</span></span>
<span><span class="co">#&gt;   id  co_true      ref       alt</span></span>
<span><span class="co">#&gt; 1  1 5.281320 5.928015  5.640380</span></span>
<span><span class="co">#&gt; 2  1 3.900623 4.211349  3.989880</span></span>
<span><span class="co">#&gt; 3  1 5.191799 5.524657  6.044544</span></span>
<span><span class="co">#&gt; 4  1 3.339882 3.456067  3.316707</span></span>
<span><span class="co">#&gt; 5  1 7.204108 8.127387  7.766766</span></span>
<span><span class="co">#&gt; 6  2 9.223510 9.022741 10.143470</span></span></code></pre></div>
</div>
<p>We first perform a Bland-Altman analysis on an absolute (non-log) scale.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">BA_sim_abs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compare_methods.html">compare_methods</a></span><span class="op">(</span></span>
<span>  <span class="va">sim_CO</span>,</span>
<span>  ref_col <span class="op">=</span> <span class="va">ref</span>,</span>
<span>  alt_col <span class="op">=</span> <span class="va">alt</span>,</span>
<span>  id_col <span class="op">=</span> <span class="va">id</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Increase nsim for real use.</span></span>
<span><span class="va">BA_sim_abs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_confint.html">add_confint</a></span><span class="op">(</span><span class="va">BA_sim_abs</span>, nsim <span class="op">=</span> <span class="fl">999</span>, .progress <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/BA_plot_combine.html">BA_plot_combine</a></span><span class="op">(</span><span class="va">BA_sim_abs</span>, aspect_ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="BAtrending_files/figure-html/unnamed-chunk-10-1.png" class="quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>The funnel-shaped scatter of differences in the Bland-Altman plot (middle panel) clearly indicates that the magnitude of the differences increases with higher CO.</p>
<p>We instead perform the analysis on log-transformed measurements. This corresponds to an assumption that measurement errors are proportional to the true CO. Specifically, that the <em>ratios</em> between simultaneous measurements from two methods are independent of the true CO.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mi>l</mi><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>r</mi><mi>e</mi><mi>f</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mi>a</mi><mi>l</mi><mi>t</mi></mrow><mrow><mi>r</mi><mi>e</mi><mi>f</mi></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\log(alt) - \log(ref) = \log\left(\frac{alt}{ref} \right)
</annotation></semantics></math></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">BA_sim_log</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compare_methods.html">compare_methods</a></span><span class="op">(</span></span>
<span>  <span class="va">sim_CO</span>,</span>
<span>  ref_col <span class="op">=</span> <span class="va">ref</span>,</span>
<span>  alt_col <span class="op">=</span> <span class="va">alt</span>,</span>
<span>  id_col <span class="op">=</span> <span class="va">id</span>,</span>
<span>  logtrans <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Increase nsim for real use.</span></span>
<span><span class="va">BA_sim_log</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_confint.html">add_confint</a></span><span class="op">(</span><span class="va">BA_sim_log</span>, nsim <span class="op">=</span> <span class="fl">999</span>, .progress <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/BA_plot_combine.html">BA_plot_combine</a></span><span class="op">(</span><span class="va">BA_sim_log</span>, aspect_ratio <span class="op">=</span> <span class="fl">1</span>, keep_log_scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="BAtrending_files/figure-html/unnamed-chunk-11-1.png" class="quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># aspect_ratio only affects the scatter plot (left panel) for</span></span>
<span><span class="co"># log-transformed data.</span></span></code></pre></div>
</div>
<p>On log-transformed measurements, there is no relationship between CO and agreement between methods (of course, this was expected, as we generated the data with proportional errors).</p>
<p>The results from the Bland-Altman analysis on log-transformed measurements (e.g. bias, limits of agreement and change limits of agreement) can be exponentiated and interpreted on the original scale. The interpretation of these back-transformed results is that they estimate ratios between the measurements instead of absolute differences.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/BA_plot_combine.html">BA_plot_combine</a></span><span class="op">(</span><span class="va">BA_sim_log</span>, aspect_ratio <span class="op">=</span> <span class="fl">1</span>, keep_log_scale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="BAtrending_files/figure-html/unnamed-chunk-12-1.png" class="quarto-figure quarto-figure-center" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>A ratio of 1 signifies “no bias” (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>l</mi><mi>t</mi><mo>=</mo><mi>r</mi><mi>e</mi><mi>f</mi></mrow><annotation encoding="application/x-tex">alt = ref</annotation></semantics></math>). The Y-axis is shown with logarithmic intervals to appropriately balance the ratios visually (i.e. an increase of 25% is balanced by a decrease of 20%).</p>
<p>A relative bias of 1.08 indicates that the alternative method measures 8% more than the reference method on average. Relative limits of agreement define the interval in which ratios between future paired measurements (in a random subject) with the same alternative and reference methods are expected to fall in 95% of cases.</p>
<p>We can also show the results of the log-transformed Bland-Altman analysis on the non-transformed data with:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/BA_plot_normalized_log.html">BA_plot_normalized_log</a></span><span class="op">(</span><span class="va">BA_sim_log</span>, aspect_ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="BAtrending_files/figure-html/unnamed-chunk-13-1.png" class="quarto-figure quarto-figure-center" style="width:50.0%"></p>
</figure>
</div>
</div>
</div>
<p>Again, we can generate a table of the back-transformed (exponentiated) results:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/BA_table.html">BA_table</a></span><span class="op">(</span><span class="va">BA_sim_log</span>, keep_log_scale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<!-- preamble start -->

    <!-- tinytable mathjax start -->
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script><!-- tinytable mathjax end --><script>

      function styleCell_m4y5baoylz3z277uhc5a(i, j, css_id) {
          var table = document.getElementById("tinytable_m4y5baoylz3z277uhc5a");
          var cell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function spanCell_m4y5baoylz3z277uhc5a(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_m4y5baoylz3z277uhc5a");
        const targetCell = table.querySelector(`[data-row="${i}"][data-col="${j}"]`);
        if (!targetCell) {
          console.warn(`Cell at (${i}, ${j}) not found.`);
        }

        // Get all cells that need to be removed
        const cellsToRemove = [];
        for (let r = 0; r < rowspan; r++) {
          for (let c = 0; c < colspan; c++) {
            if (r === 0 && c === 0) continue; // Skip the target cell
            const cell = table.querySelector(`[data-row="${i + r}"][data-col="${j + c}"]`);
            if (cell) {
              cellsToRemove.push(cell);
            }
          }
        }

        // Remove all cells
        cellsToRemove.forEach(cell => cell.remove());

        // Set rowspan and colspan of the target cell if it exists
        if (targetCell) {
          targetCell.rowSpan = rowspan;
          targetCell.colSpan = colspan;
        }
      }
      // tinytable span after
      window.addEventListener('load', function () { spanCell_m4y5baoylz3z277uhc5a(11, 0, 1, 2) })
      window.addEventListener('load', function () { spanCell_m4y5baoylz3z277uhc5a(6, 0, 1, 2) })
      window.addEventListener('load', function () { spanCell_m4y5baoylz3z277uhc5a(1, 0, 1, 2) })
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: '16', j: 0 }, { i: '16', j: 1 },  ], css_id: 'tinytable_css_pqwzqe8fmgttkco1b0em',},
          { positions: [ { i: '0', j: 0 }, { i: '0', j: 1 },  ], css_id: 'tinytable_css_trhw5n05o82myj50e9qc',},
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_m4y5baoylz3z277uhc5a(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script><style>
      /* tinytable css entries after */
      .table td.tinytable_css_pqwzqe8fmgttkco1b0em, .table th.tinytable_css_pqwzqe8fmgttkco1b0em { border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_trhw5n05o82myj50e9qc, .table th.tinytable_css_trhw5n05o82myj50e9qc { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
<div class="container">
      <table class="table table table-borderless" id="tinytable_m4y5baoylz3z277uhc5a" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
<thead><tr>
<th scope="col" data-row="0" data-col="0"></th>
                <th scope="col" data-row="0" data-col="1">Estimate [95% CI]</th>
              </tr></thead>
<tfoot>
<tr><td colspan="2">
<sup>1</sup> Distribution of the averages of simultaneous measurements (alt + ref)/2.</td></tr>
<tr><td colspan="2">
<sup>2</sup> Percentage error = 1.96 · \(\sigma_{total,D}\) (or \(\sigma_{within,D}\))/mean</td></tr>
<tr><td colspan="2">
<sup>3</sup> Change limits of agreement (95%) = 1.96 · √2 · \(\sigma_{within,D}\).</td></tr>
<tr><td colspan="2">
<sup></sup> SD: standard deviation; alt: alternative method; ref: reference method; ⋇: multiply or divide</td></tr>
</tfoot>
<tbody>
<tr>
<td data-row="1" data-col="0">
<strong>Distribution</strong><sup>1</sup>
</td>
                  <td data-row="1" data-col="1"><strong>Distribution</strong></td>
                </tr>
<tr>
<td data-row="2" data-col="0">Mean</td>
                  <td data-row="2" data-col="1">5.58 [5.28; 5.87]</td>
                </tr>
<tr>
<td data-row="3" data-col="0">Between-subject SD</td>
                  <td data-row="3" data-col="1">0.67 [0.19; 0.98]</td>
                </tr>
<tr>
<td data-row="4" data-col="0">Within-subject SD</td>
                  <td data-row="4" data-col="1">1.73 [1.57; 1.90]</td>
                </tr>
<tr>
<td data-row="5" data-col="0">Total SD</td>
                  <td data-row="5" data-col="1">1.86 [1.70; 2.04]</td>
                </tr>
<tr>
<td data-row="6" data-col="0"><strong>Method comparison, exp(log-analysis), (alt / ref)</strong></td>
                  <td data-row="6" data-col="1"><strong>Method comparison, exp(log-analysis), (alt / ref)</strong></td>
                </tr>
<tr>
<td data-row="7" data-col="0">Bias</td>
                  <td data-row="7" data-col="1">1.08 [1.05; 1.11]</td>
                </tr>
<tr>
<td data-row="8" data-col="0">Between-subject SD (\(\sigma_{between,D}\))</td>
                  <td data-row="8" data-col="1">1.12 [1.09; 1.15]</td>
                </tr>
<tr>
<td data-row="9" data-col="0">Within-subject SD (\(\sigma_{within,D}\))</td>
                  <td data-row="9" data-col="1">1.08 [1.07; 1.09]</td>
                </tr>
<tr>
<td data-row="10" data-col="0">Total SD (\(\sigma_{total,D}\))</td>
                  <td data-row="10" data-col="1">1.14 [1.12; 1.17]</td>
                </tr>
<tr>
<td data-row="11" data-col="0">Limits of agreement (95%)</td>
                  <td data-row="11" data-col="1">Limits of agreement (95%)</td>
                </tr>
<tr>
<td data-row="12" data-col="0">  Upper limit</td>
                  <td data-row="12" data-col="1">1.41 [1.34; 1.47]</td>
                </tr>
<tr>
<td data-row="13" data-col="0">  Lower limit</td>
                  <td data-row="13" data-col="1">0.83 [0.79; 0.87]</td>
                </tr>
<tr>
<td data-row="14" data-col="0">Percentage error<sup>2</sup>
</td>
                  <td data-row="14" data-col="1">–</td>
                </tr>
<tr>
<td data-row="15" data-col="0">Within-subject percentage error<sup>2</sup>
</td>
                  <td data-row="15" data-col="1">–</td>
                </tr>
<tr>
<td data-row="16" data-col="0">Change limits of agreement (95%)<sup>3</sup>
</td>
                  <td data-row="16" data-col="1">⋇1.23 [1.21; 1.26]</td>
                </tr>
</tbody>
</table>
</div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
<p>The back-transformed <em>change limits of agreement</em> is 1.23. This is interpreted as: if we measure a change in CO with both methods simultaneously, we expect the change from one method to be at most 23% higher than the other method in 95% of cases.</p>
<p>Percentage errors are not meaningful for log-transformed data and are also not needed. A Bland-Altman analysis on log-transformed data inherently gives measures of agreement that are relative to the measured value.</p>
<p>To compare results from an analysis on log-transformed measurements with an analysis on absolute (non-transformed) measurements, the SD of differences between log-transformed measurements (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mo>log</mo></msub><mo>=</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>C</mi><msub><mi>O</mi><mrow><mi>a</mi><mi>l</mi><mi>t</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>C</mi><msub><mi>O</mi><mrow><mi>r</mi><mi>e</mi><mi>f</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">D_{\log} = \log(CO_{alt}) - \log(CO_{ref})</annotation></semantics></math>) is approximately equal to the SD of differences on the original measurements (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>D</mi><annotation encoding="application/x-tex">D</annotation></semantics></math>) relative to the mean of these measurements:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>D</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>D</mi><mo>log</mo></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>≈</mo><mfrac><mrow><mi>S</mi><mi>D</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>D</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>m</mi><mi>e</mi><mi>a</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>C</mi><msub><mi>O</mi><mrow><mi>a</mi><mi>l</mi><mi>t</mi></mrow></msub><mo>,</mo><mi>C</mi><msub><mi>O</mi><mrow><mi>r</mi><mi>e</mi><mi>f</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>,</mo></mrow><annotation encoding="application/x-tex">
SD(D_{\log}) \approx \frac{SD(D)}{mean(CO_{alt}, CO_{ref})},
</annotation></semantics></math></p>
<p>when <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>D</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>D</mi><mo>log</mo></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">SD(D_{\log})</annotation></semantics></math> is less than approximately 0.3. Note that <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>log</mo><annotation encoding="application/x-tex">\log</annotation></semantics></math> must be the natural logarithm (base <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>e</mi><annotation encoding="application/x-tex">e</annotation></semantics></math>) for this approximate equality to hold.</p>
<p>Thus, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1.96</mn><mo>*</mo><mi>S</mi><msub><mi>D</mi><mrow><mi>t</mi><mi>o</mi><mi>t</mi><mi>a</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">1.96 * SD_{total}</annotation></semantics></math> on the log scale is approximately equal to the “percentage error” that would be calculated on the original scale.</p>
<p>This is analogous to how the coefficient of variation (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>V</mi><mo>=</mo><mi>S</mi><mi>D</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mi>m</mi><mi>e</mi><mi>a</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">CV = SD(x)/mean(x)</annotation></semantics></math>) is approximately equal to <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>D</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>l</mi><mi>o</mi><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">SD(log(x))</annotation></semantics></math><a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;R. C. Lewontin, On the Measurement of Relative Variability, Systematic Biology, Volume 15, Issue 2, June 1966, Pages 141–142, https://doi.org/10.2307/sysbio/15.2.141&lt;/p&gt;"><sup>1</sup></a>.</p>
</section><section class="level2"><h2 id="manually-fit-the-mixed-model-and-extract-features">Manually fit the mixed model and extract features<a class="anchor" aria-label="anchor" href="#manually-fit-the-mixed-model-and-extract-features"></a>
</h2>
<p>While <code>BAtrending</code> conveniently fits a mixed effects model and extracts relevant variables, it is useful to understand how to do this manually.</p>
<p>We will use the <code>CO</code> dataset again, and use <code><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lme4::lmer()</a></code> to fit the same model as used in <code><a href="../reference/compare_methods.html">compare_methods()</a></code>.</p>
<p>First, we calculate the difference and average for each pair of simultaneous measurements.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CO_diff_avg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">CO</span>, diff <span class="op">=</span> <span class="va">ic</span> <span class="op">-</span> <span class="va">rv</span>, avg <span class="op">=</span> <span class="op">(</span><span class="va">ic</span> <span class="op">+</span> <span class="va">rv</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">CO_diff_avg</span><span class="op">)</span></span>
<span><span class="co">#&gt;   sub   rv   ic  diff   avg</span></span>
<span><span class="co">#&gt; 1   1 7.83 6.57 -1.26 7.200</span></span>
<span><span class="co">#&gt; 2   1 7.42 5.62 -1.80 6.520</span></span>
<span><span class="co">#&gt; 3   1 7.89 6.90 -0.99 7.395</span></span>
<span><span class="co">#&gt; 4   1 7.12 6.57 -0.55 6.845</span></span>
<span><span class="co">#&gt; 5   1 7.88 6.35 -1.53 7.115</span></span>
<span><span class="co">#&gt; 6   2 6.16 4.06 -2.10 5.110</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/" class="external-link">lme4</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">diff</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">sub</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">CO_diff_avg</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; Linear mixed model fit by REML ['lmerMod']</span></span>
<span><span class="co">#&gt; Formula: diff ~ 1 + (1 | sub)</span></span>
<span><span class="co">#&gt;    Data: CO_diff_avg</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; REML criterion at convergence: 103.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Scaled residuals: </span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -2.19408 -0.62492 -0.08043  0.57449  2.15307 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Groups   Name        Variance Std.Dev.</span></span>
<span><span class="co">#&gt;  sub      (Intercept) 0.8728   0.9342  </span></span>
<span><span class="co">#&gt;  Residual             0.1708   0.4133  </span></span>
<span><span class="co">#&gt; Number of obs: 60, groups:  sub, 12</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed effects:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value</span></span>
<span><span class="co">#&gt; (Intercept)  -0.7045     0.2752   -2.56</span></span></code></pre></div>
</div>
<p>We can see that the bias (the only fixed effect) is -0.70, the between-subject SD is 0.93 and within-subject (Residual) SD is 0.41.</p>
<p>To extract these values programmatically, use:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bias</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/fixed.effects.html" class="external-link">fixef</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="co"># Get intercept from model</span></span>
<span><span class="co"># Get variance components (SD)</span></span>
<span><span class="va">sd_components</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/VarCorr.html" class="external-link">VarCorr</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="st">'sdcor'</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
</div>
<p>Most Bland-Altman statistics are calculated from these values:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">calc_BA_stats_from_model</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">bias</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/fixed.effects.html" class="external-link">fixef</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="co"># Get intercept from model</span></span>
<span>  <span class="co"># Get variance components (SD)</span></span>
<span>  <span class="va">sd_components</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/VarCorr.html" class="external-link">VarCorr</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="st">'sdcor'</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span>  <span class="va">sd.between</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">sd_components</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">sd.within</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">sd_components</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">sd.total</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">sd.between</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">sd.within</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">intraclass.correlation</span> <span class="op">&lt;-</span> <span class="va">sd.between</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="va">sd.total</span><span class="op">^</span><span class="fl">2</span></span>
<span></span>
<span>  <span class="va">loa.lwr</span> <span class="op">&lt;-</span> <span class="va">bias</span> <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">sd.total</span></span>
<span>  <span class="va">loa.upr</span> <span class="op">&lt;-</span> <span class="va">bias</span> <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">sd.total</span></span>
<span></span>
<span>  <span class="va">change.loa</span> <span class="op">&lt;-</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="va">sd.within</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    bias <span class="op">=</span> <span class="va">bias</span>,</span>
<span>    sd.between <span class="op">=</span> <span class="va">sd.between</span>,</span>
<span>    sd.within <span class="op">=</span> <span class="va">sd.within</span>,</span>
<span>    sd.total <span class="op">=</span> <span class="va">sd.total</span>,</span>
<span>    intraclass.correlation <span class="op">=</span> <span class="va">intraclass.correlation</span>,</span>
<span>    loa.lwr <span class="op">=</span> <span class="va">loa.lwr</span>,</span>
<span>    loa.upr <span class="op">=</span> <span class="va">loa.upr</span>,</span>
<span>    change.loa <span class="op">=</span> <span class="va">change.loa</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">ba_stats</span> <span class="op">&lt;-</span> <span class="fu">calc_BA_stats_from_model</span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span><span class="va">ba_stats</span></span>
<span><span class="co">#&gt;                   bias             sd.between              sd.within </span></span>
<span><span class="co">#&gt;             -0.7045210              0.9342410              0.4132823 </span></span>
<span><span class="co">#&gt;               sd.total intraclass.correlation                loa.lwr </span></span>
<span><span class="co">#&gt;              1.0215716              0.8363349             -2.7068013 </span></span>
<span><span class="co">#&gt;                loa.upr             change.loa </span></span>
<span><span class="co">#&gt;              1.2977593              1.1455601</span></span></code></pre></div>
</div>
<p>Percentage errors also require knowing the mean of the measurements.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mean_val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">CO_diff_avg</span><span class="op">$</span><span class="va">avg</span><span class="op">)</span></span>
<span></span>
<span><span class="va">percentage.error</span> <span class="op">&lt;-</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">ba_stats</span><span class="op">[</span><span class="st">"sd.total"</span><span class="op">]</span> <span class="op">/</span> <span class="va">mean_val</span></span>
<span><span class="va">percentage.error.within</span> <span class="op">&lt;-</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">ba_stats</span><span class="op">[</span><span class="st">"sd.within"</span><span class="op">]</span> <span class="op">/</span> <span class="va">mean_val</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  percentage.error <span class="op">=</span> <span class="va">percentage.error</span>,</span>
<span>  percentage.error.within <span class="op">=</span> <span class="va">percentage.error.within</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;         percentage.error.sd.total percentage.error.within.sd.within </span></span>
<span><span class="co">#&gt;                         0.3986290                         0.1612675</span></span></code></pre></div>
</div>
<p>Here, we use the simple mean of all measurements. In <code><a href="../reference/compare_methods.html">compare_methods()</a></code> the mean value is estimated from a mixed model that accounts for repeated measurements within subjects (<code>avg ~ 1 + (1|sub)</code>). This model is also used for describing the distribution of measurements (e.g. <code>BA_CO$distribution_stats</code>).</p>
<section class="level3"><h3 id="bootstrap-confidence-intervals">Bootstrap confidence intervals<a class="anchor" aria-label="anchor" href="#bootstrap-confidence-intervals"></a>
</h3>
<p>To calculate confidence intervals (CI) for the Bland-Altman statistics, we can use a parametric bootstrap on the model.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">lme4</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lme4/man/confint.merMod.html" class="external-link">confint.merMod</a></span><span class="op">(</span></span>
<span>  <span class="va">mod</span>,</span>
<span>  FUN <span class="op">=</span> <span class="va">calc_BA_stats_from_model</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"boot"</span>,</span>
<span>  nsim <span class="op">=</span> <span class="fl">500</span>, <span class="co"># increase nsim for actual analysis</span></span>
<span>  boot.type <span class="op">=</span> <span class="st">"perc"</span>,</span>
<span>  .progress <span class="op">=</span> <span class="st">"none"</span> <span class="co"># hide progress bar</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;                             2.5 %     97.5 %</span></span>
<span><span class="co">#&gt; bias                   -1.2591921 -0.1979777</span></span>
<span><span class="co">#&gt; sd.between              0.4937674  1.3230741</span></span>
<span><span class="co">#&gt; sd.within               0.3298689  0.4988472</span></span>
<span><span class="co">#&gt; sd.total                0.6389897  1.3833602</span></span>
<span><span class="co">#&gt; intraclass.correlation  0.5668726  0.9210345</span></span>
<span><span class="co">#&gt; loa.lwr                -3.5834825 -1.8390891</span></span>
<span><span class="co">#&gt; loa.upr                 0.2788395  2.1981297</span></span>
<span><span class="co">#&gt; change.loa              0.9143500  1.3827340</span></span></code></pre></div>
</div>
<p>This does not calculate CIs for the percentage errors, since this requires an estimate of the mean CO, which is not part of this mixed model. In <code>BAtrending</code>, CIs for percentage error are calculated by scaling the CI for <code>sd.total</code>, treating the mean CO as a known value. Ideally, the uncertainty of the mean CO should be included in the CI for the percentage error.</p>
</section></section><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config);
    }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Johannes Enevoldsen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
